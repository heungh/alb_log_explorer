<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALB Access Log ë³´ì•ˆ ë¶„ì„ ë³´ê³ ì„œ</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        h1 { color: #d32f2f; text-align: center; border-bottom: 3px solid #d32f2f; padding-bottom: 10px; }
        h2 { color: #1976d2; border-left: 4px solid #1976d2; padding-left: 15px; margin-top: 30px; }
        h3 { color: #388e3c; }
        .alert-critical { background: #ffebee; border-left: 5px solid #f44336; padding: 15px; margin: 20px 0; }
        .alert-warning { background: #fff3e0; border-left: 5px solid #ff9800; padding: 15px; margin: 20px 0; }
        .alert-info { background: #e3f2fd; border-left: 5px solid #2196f3; padding: 15px; margin: 20px 0; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #f5f5f5; font-weight: bold; }
        .code-block { background: #f8f8f8; border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 5px; overflow-x: auto; }
        .metric-box { display: inline-block; background: #e8f5e8; border: 2px solid #4caf50; padding: 15px; margin: 10px; border-radius: 8px; text-align: center; min-width: 150px; }
        .threat-box { display: inline-block; background: #ffebee; border: 2px solid #f44336; padding: 15px; margin: 10px; border-radius: 8px; text-align: center; min-width: 150px; }
        .timeline { border-left: 3px solid #2196f3; padding-left: 20px; margin: 20px 0; }
        .timeline-item { margin: 20px 0; padding: 10px; background: #f9f9f9; border-radius: 5px; }
        .evidence-list { background: #fff3e0; padding: 20px; border-radius: 8px; margin: 15px 0; }
        .recommendation { background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 10px 0; border-left: 4px solid #4caf50; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš¨ ALB Access Log ë³´ì•ˆ ë¶„ì„ ë³´ê³ ì„œ</h1>
        <p style="text-align: center; font-size: 18px; color: #666;">
            <strong>ë¶„ì„ ê¸°ê°„:</strong> 2024ë…„ 7ì›”-8ì›” | 
            <strong>ì´ ìš”ì²­:</strong> 3,659,312ê±´ | 
            <strong>ìœ„í—˜ë„:</strong> <span style="color: #d32f2f; font-weight: bold;">ğŸ”´ CRITICAL</span>
        </p>

        <div class="alert-critical">
            <h3>âš ï¸ ê¸´ê¸‰ ë³´ì•ˆ ê²½ê³ </h3>
            <p><strong>13.124.46.40</strong> IPì—ì„œ ëŒ€ê·œëª¨ ìë™í™” ë´‡ ê³µê²©ì´ íƒì§€ë˜ì—ˆìŠµë‹ˆë‹¤. ì¦‰ì‹œ ì°¨ë‹¨ ì¡°ì¹˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
        </div>

        <h2>ğŸ“Š ê³µê²© ê·œëª¨ ê°œìš”</h2>
        <div style="text-align: center;">
            <div class="threat-box">
                <h4>ë´‡ ê³µê²© IP</h4>
                <div style="font-size: 24px; color: #d32f2f;">13.124.46.40</div>
                <div>1,815,063 ìš”ì²­</div>
            </div>
            <div class="metric-box">
                <h4>ì •ìƒ ì‚¬ìš©ì IP</h4>
                <div style="font-size: 24px; color: #4caf50;">140.248.29.3</div>
                <div>14,593 ìš”ì²­</div>
            </div>
            <div class="threat-box">
                <h4>ê³µê²© ë¹„ìœ¨</h4>
                <div style="font-size: 24px; color: #d32f2f;">49.6%</div>
                <div>ì „ì²´ íŠ¸ë˜í”½ì˜ ì ˆë°˜</div>
            </div>
        </div>

        <h2>ğŸ” ë´‡ ê³µê²© ì¦ê±° ë¶„ì„</h2>
        
        <h3>1. í¬íŠ¸ ì‚¬ìš© íŒ¨í„´ ë¶„ì„</h3>
        <div class="evidence-list">
            <h4>ğŸš© ë¹„ì •ìƒì  í¬íŠ¸ ì‚¬ìš© íŒ¨í„´</h4>
            <table>
                <tr><th>êµ¬ë¶„</th><th>13.124.46.40 (ë´‡)</th><th>140.248.29.3 (ì •ìƒ)</th><th>ì°¨ì´</th></tr>
                <tr><td>ì‚¬ìš© í¬íŠ¸ ìˆ˜</td><td style="color: #d32f2f;"><strong>64,510ê°œ</strong></td><td>380ê°œ</td><td>170ë°°</td></tr>
                <tr><td>í¬íŠ¸ë‹¹ í‰ê·  ìš”ì²­</td><td style="color: #d32f2f;"><strong>28ê°œ (ê·œì¹™ì )</strong></td><td>38ê°œ (ë¶ˆê·œì¹™)</td><td>ì²´ê³„ì  ë¶„ì‚°</td></tr>
                <tr><td>í¬íŠ¸ ë²”ìœ„</td><td style="color: #d32f2f;"><strong>1024-65535 ìˆœì°¨</strong></td><td>ëœë¤</td><td>ìë™í™” ì¦ê±°</td></tr>
            </table>
            
            <div class="alert-warning">
                <strong>ì™œ ì´ê²ƒì´ ë´‡ ê³µê²©ì˜ ì¦ê±°ì¸ê°€?</strong><br>
                â€¢ <strong>ì •ìƒ ì‚¬ìš©ì</strong>: ë¸Œë¼ìš°ì €ë‚˜ ì•±ì—ì„œ 1-10ê°œ í¬íŠ¸ë§Œ ì‚¬ìš©<br>
                â€¢ <strong>ë´‡/ìŠ¤í¬ë¦½íŠ¸</strong>: ì—°ê²° í’€ë§ìœ¼ë¡œ ìˆ˜ë§Œê°œ í¬íŠ¸ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì‚¬ìš©<br>
                â€¢ <strong>64,510ê°œ í¬íŠ¸</strong>ëŠ” ì¸ê°„ì´ ë¶ˆê°€ëŠ¥í•œ ìˆ˜ì¤€ì˜ ë™ì‹œ ì—°ê²°
            </div>
        </div>

        <h3>2. API ê³µê²© íŒ¨í„´ ë¶„ì„</h3>
        <div class="evidence-list">
            <h4>ğŸ¯ ì§‘ì¤‘ ê³µê²© ëŒ€ìƒ API</h4>
            <table>
                <tr><th>API ì—”ë“œí¬ì¸íŠ¸</th><th>ìš”ì²­ ìˆ˜</th><th>ë¹„ìœ¨</th><th>ê³µê²© ëª©ì </th></tr>
                <tr><td>/api/auth/session</td><td style="color: #d32f2f;"><strong>487,085</strong></td><td>26.8%</td><td>ì„¸ì…˜ í•˜ì´ì¬í‚¹</td></tr>
                <tr><td>/api/balcony-api/user/adult/toggle</td><td style="color: #d32f2f;"><strong>312,194</strong></td><td>17.2%</td><td>ì„±ì¸ ì½˜í…ì¸  ìš°íšŒ</td></tr>
                <tr><td>/api/balcony-api/user</td><td style="color: #d32f2f;"><strong>312,192</strong></td><td>17.2%</td><td>ì‚¬ìš©ì ì •ë³´ ìˆ˜ì§‘</td></tr>
            </table>
            
            <div class="alert-warning">
                <strong>ê³µê²© ì˜ë„ ë¶„ì„:</strong><br>
                â€¢ <strong>ì„¸ì…˜ API ëŒ€ëŸ‰ í˜¸ì¶œ</strong>: ìœ íš¨í•œ ì„¸ì…˜ í† í° íƒˆì·¨ ì‹œë„<br>
                â€¢ <strong>ì„±ì¸ ì½˜í…ì¸  í† ê¸€</strong>: ì—°ë ¹ ì œí•œ ìš°íšŒ ì‹œë„<br>
                â€¢ <strong>ì‚¬ìš©ì ì •ë³´ API</strong>: ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ê³„ì • íƒˆì·¨ ì‹œë„
            </div>
        </div>

        <h3>3. ì‘ë‹µì‹œê°„ íŒ¨í„´ ë¶„ì„</h3>
        <div class="evidence-list">
            <h4>â±ï¸ ìë™í™” ë„êµ¬ ì‚¬ìš© ì¦ê±°</h4>
            <table>
                <tr><th>ì‘ë‹µì‹œê°„ íŒ¨í„´</th><th>ë°œìƒ íšŸìˆ˜</th><th>íŠ¹ì§•</th></tr>
                <tr><td>1096ms / 174ms</td><td style="color: #d32f2f;"><strong>43,198íšŒ</strong></td><td>ë§¤ìš° ê·œì¹™ì </td></tr>
                <tr><td>1095ms / 174ms</td><td style="color: #d32f2f;"><strong>42,261íšŒ</strong></td><td>1ms ì°¨ì´ë¡œ ë°˜ë³µ</td></tr>
                <tr><td>521ms / 535ms</td><td style="color: #d32f2f;"><strong>26,033íšŒ</strong></td><td>ì„¸ì…˜ API ì „ìš©</td></tr>
            </table>
            
            <div class="alert-warning">
                <strong>ì™œ ì´ê²ƒì´ ìë™í™”ì˜ ì¦ê±°ì¸ê°€?</strong><br>
                â€¢ <strong>ì •ìƒ ì‚¬ìš©ì</strong>: ë„¤íŠ¸ì›Œí¬ ì§€ì—°, ì„œë²„ ë¶€í•˜ë¡œ ì‘ë‹µì‹œê°„ì´ ë¶ˆê·œì¹™<br>
                â€¢ <strong>ë´‡/ìŠ¤í¬ë¦½íŠ¸</strong>: ë™ì¼í•œ í™˜ê²½ì—ì„œ ì‹¤í–‰ë˜ì–´ ì‘ë‹µì‹œê°„ì´ ë§¤ìš° ê·œì¹™ì <br>
                â€¢ <strong>1ms ë‹¨ìœ„ ë°˜ë³µ</strong>ì€ ì¸ê°„ì˜ í´ë¦­ íŒ¨í„´ìœ¼ë¡œëŠ” ë¶ˆê°€ëŠ¥
            </div>
        </div>

        <h2>ğŸ”¬ ê¸°ìˆ ì  ë¶„ì„: ê³µê²© ë©”ì»¤ë‹ˆì¦˜</h2>
        
        <h3>1. AWS ì¸í”„ë¼ ì•…ìš© ë¶„ì„</h3>
        <div class="alert-info">
            <h4>ğŸŒ ì§€ë¦¬ì  ì •ë³´ ë¶„ì„</h4>
            <p><strong>13.124.46.40</strong>ì€ AWS ap-northeast-2 (ì„œìš¸) ë¦¬ì „ì˜ IP ëŒ€ì—­ì…ë‹ˆë‹¤.</p>
            <div class="code-block">
# IP ëŒ€ì—­ í™•ì¸
$ whois 13.124.46.40
NetRange: 13.124.0.0 - 13.124.255.255
Organization: Amazon Technologies Inc. (AT-88-Z)
Country: KR (South Korea)
            </div>
            
            <div class="alert-warning">
                <strong>ì™œ AWS IPê°€ ìœ„í—˜í•œê°€?</strong><br>
                â€¢ <strong>ì‹ ë¢°ì„± ì•…ìš©</strong>: AWS IPëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì°¨ë‹¨ ëŒ€ìƒì´ ì•„ë‹˜<br>
                â€¢ <strong>í™•ì¥ì„±</strong>: EC2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ í†µí•œ ëŒ€ê·œëª¨ ë¶„ì‚° ê³µê²© ê°€ëŠ¥<br>
                â€¢ <strong>ìµëª…ì„±</strong>: ì‹¤ì œ ê³µê²©ì ì¶”ì ì´ ì–´ë ¤ì›€<br>
                â€¢ <strong>ë¹„ìš© íš¨ìœ¨ì„±</strong>: ì €ë ´í•œ ë¹„ìš©ìœ¼ë¡œ ëŒ€ëŸ‰ íŠ¸ë˜í”½ ìƒì„± ê°€ëŠ¥
            </div>
        </div>

        <h3>2. ì—°ê²° í’€ë§ ê³µê²© ê¸°ë²•</h3>
        <div class="evidence-list">
            <h4>ğŸ”— í¬íŠ¸ ìŠ¤ìº” vs ì—°ê²° í’€ë§</h4>
            <table>
                <tr><th>êµ¬ë¶„</th><th>í¬íŠ¸ ìŠ¤ìº”</th><th>ì—°ê²° í’€ë§ ê³µê²©</th><th>13.124.46.40 íŒ¨í„´</th></tr>
                <tr><td>ëª©ì </td><td>ì—´ë¦° í¬íŠ¸ íƒì§€</td><td>ì„œë¹„ìŠ¤ ë¶€í•˜ ìœ ë°œ</td><td style="color: #d32f2f;">âœ“ ì—°ê²° í’€ë§</td></tr>
                <tr><td>í¬íŠ¸ë‹¹ ìš”ì²­</td><td>1-2ê°œ</td><td>ìˆ˜ì‹­ê°œ</td><td style="color: #d32f2f;">âœ“ í‰ê·  28ê°œ</td></tr>
                <tr><td>ì§€ì†ì„±</td><td>ì§§ìŒ</td><td>ì¥ê¸°ê°„</td><td style="color: #d32f2f;">âœ“ ì¥ê¸°ê°„</td></tr>
                <tr><td>íŒ¨í„´</td><td>ìˆœì°¨ì </td><td>ì²´ê³„ì  ë¶„ì‚°</td><td style="color: #d32f2f;">âœ“ ì²´ê³„ì </td></tr>
            </table>
            
            <div class="code-block">
# ê³µê²©ìê°€ ì‚¬ìš©í•œ ê²ƒìœ¼ë¡œ ì¶”ì •ë˜ëŠ” ê¸°ë²•
import asyncio
import aiohttp

async def attack_session():
    connector = aiohttp.TCPConnector(
        limit=65000,  # ìµœëŒ€ ì—°ê²° ìˆ˜
        limit_per_host=65000
    )
    
    # 64,510ê°œ í¬íŠ¸ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì‚¬ìš©
    for port in range(1024, 65535):
        # ê° í¬íŠ¸ë‹¹ í‰ê·  28íšŒ ìš”ì²­
        for _ in range(28):
            await make_request(f":{port}")
            </div>
        </div>

        <h2>ğŸ›¡ï¸ ì¦‰ì‹œ ëŒ€ì‘ ë°©ì•ˆ</h2>
        
        <div class="recommendation">
            <h3>1. ê¸´ê¸‰ ì°¨ë‹¨ ì¡°ì¹˜ (ì¦‰ì‹œ ì‹¤í–‰)</h3>
            <div class="code-block">
# AWS WAF ê·œì¹™ ì¶”ê°€
aws wafv2 create-rule \
  --name "Block-Malicious-IP" \
  --rule '{
    "Name": "BlockIP13124464640",
    "Priority": 1,
    "Statement": {
      "IPSetReferenceStatement": {
        "ARN": "arn:aws:wafv2:ap-northeast-2:account:ipset/malicious-ips"
      }
    },
    "Action": {"Block": {}},
    "VisibilityConfig": {
      "SampledRequestsEnabled": true,
      "CloudWatchMetricsEnabled": true,
      "MetricName": "BlockMaliciousIP"
    }
  }'

# Security Group ê·œì¹™ ì¶”ê°€
aws ec2 authorize-security-group-ingress \
  --group-id sg-xxxxxxxxx \
  --protocol tcp \
  --port 443 \
  --source-group sg-xxxxxxxxx \
  --rule-description "Block 13.124.46.40"
            </div>
        </div>

        <div class="recommendation">
            <h3>2. API Rate Limiting ì„¤ì •</h3>
            <div class="code-block">
# API Gateway Rate Limiting
{
  "throttle": {
    "rateLimit": 100,
    "burstLimit": 200
  },
  "quota": {
    "limit": 10000,
    "period": "DAY"
  },
  "per_route_throttle": {
    "/api/auth/session": {
      "rateLimit": 10,
      "burstLimit": 20
    }
  }
}
            </div>
        </div>

        <h2>ğŸ“ˆ ë¶„ì„ ì‹œìŠ¤í…œ êµ¬ì¶• ê³¼ì •</h2>
        
        <h3>ì‚¬ìš©ëœ ë„êµ¬ ë° ìŠ¤í¬ë¦½íŠ¸</h3>
        <div class="code-block">
# 1. ë°ì´í„° íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
setup_analytics_pipeline.py  # S3, Glue, Athena ì„¤ì •
athena_setup.py             # Athena ì›Œí¬ê·¸ë£¹ ìƒì„±
fix_table_schema.py         # í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ìˆ˜ì •

# 2. ë¶„ì„ ìŠ¤í¬ë¦½íŠ¸
anomaly_analysis.py         # ì´ìƒ íŒ¨í„´ íƒì§€
security_analysis.py        # ë³´ì•ˆ ìœ„í˜‘ ë¶„ì„
ip_detailed_analysis.py     # IPë³„ ìƒì„¸ ë¶„ì„

# 3. SQL ì¿¼ë¦¬
basic_stats.sql            # ê¸°ë³¸ í†µê³„
top_ips_updated.sql        # IPë³„ íŠ¸ë˜í”½ ë¶„ì„
request_analysis.sql       # ìš”ì²­ íŒ¨í„´ ë¶„ì„
response_time_analysis.sql # ì‘ë‹µì‹œê°„ ë¶„ì„
        </div>

        <h2>ğŸ“Š ê²°ë¡  ë° ê¶Œê³ ì‚¬í•­</h2>
        
        <div class="alert-critical">
            <h3>âš ï¸ ìµœì¢… ê²°ë¡ </h3>
            <p><strong>13.124.46.40</strong>ì€ ëª…ë°±í•œ ìë™í™” ë´‡ ê³µê²©ìœ¼ë¡œ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
            <ul>
                <li>64,510ê°œ í¬íŠ¸ ì‚¬ìš© (ì •ìƒ ì‚¬ìš©ìì˜ 170ë°°)</li>
                <li>1.8M+ ìš”ì²­ìœ¼ë¡œ ì „ì²´ íŠ¸ë˜í”½ì˜ 49.6% ì°¨ì§€</li>
                <li>ì„¸ì…˜ í•˜ì´ì¬í‚¹ ë° ê°œì¸ì •ë³´ ìˆ˜ì§‘ ì‹œë„</li>
                <li>AWS ì¸í”„ë¼ë¥¼ ì•…ìš©í•œ ê³ ë„í™”ëœ ê³µê²©</li>
            </ul>
        </div>

        <div class="recommendation">
            <h3>ğŸ¯ í–¥í›„ ë³´ì•ˆ ê°•í™” ë°©ì•ˆ</h3>
            <ol>
                <li><strong>ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§</strong>: CloudWatch + Lambda ê¸°ë°˜ ìë™ íƒì§€</li>
                <li><strong>ML ê¸°ë°˜ ì´ìƒ íƒì§€</strong>: SageMakerë¥¼ í™œìš©í•œ íŒ¨í„´ í•™ìŠµ</li>
                <li><strong>API ë³´ì•ˆ ê°•í™”</strong>: JWT í† í°, CAPTCHA ë„ì…</li>
                <li><strong>ì§€ë¦¬ì  ì°¨ë‹¨</strong>: íŠ¹ì • ì§€ì—­ IP ëŒ€ì—­ ì œí•œ</li>
                <li><strong>ì •ê¸° ë³´ì•ˆ ê°ì‚¬</strong>: ì›” 1íšŒ ë¡œê·¸ ë¶„ì„ ë° ìœ„í˜‘ í‰ê°€</li>
            </ol>
        </div>

        <hr style="margin: 40px 0;">
        <p style="text-align: center; color: #666; font-size: 14px;">
            <strong>ë³´ê³ ì„œ ì‘ì„±ì¼:</strong> 2025-08-21 | 
            <strong>ë¶„ì„ ë„êµ¬:</strong> AWS Glue, Athena, Python | 
            <strong>ìœ„í—˜ë„:</strong> ğŸ”´ CRITICAL
        </p>
    </div>
</body>
</html>
